// Generated by CoffeeScript 1.4.0
var dao, dateUtil, mailUtil;

dateUtil = require('../util/dateUtil');

mailUtil = require('../util/mailUtil');

dao = require('../models/BlogDao');

exports.get = function(req, res) {
  var df;
  df = dateUtil.time();
  console.log("time:\t" + df);
  return dao.all({
    del_status: 0
  }, {
    only: ['id', 'title', 'update_time'],
    order: ['-id']
  }, function(err, blogs) {
    var b, blog, _i, _len;
    console.log(err || blogs);
    for (_i = 0, _len = blogs.length; _i < _len; _i++) {
      blog = blogs[_i];
      for (b in blog) {
        if (blog[b] instanceof Date) {
          blog[b] = dateUtil.format(blog[b]);
        }
      }
    }
    return res.render('index', {
      title: 'snode',
      blogs: blogs
    });
  });
};

exports.mail = function(req, res) {
  var code, user;
  user = {
    email: "596392912@qq.com",
    nick_name: "春梦"
  };
  code = "123123";
  mailUtil.sendSignup(user, code);
  return res.render('index', {
    name: 'snode'
  });
};
