// Generated by CoffeeScript 1.4.0
var dao;

dao = require('../../models/BlogDao');

exports.getAdd = function(req, res) {
  return res.render('admin/blog-add', {
    title: 'snode写博'
  });
};

exports.postAdd = function(req, res) {
  var blog;
  blog = req.body.blog;
  console.log(blog);
  return dao.save(blog, function(err, results) {
    return res.render('admin/blog-add', {
      title: 'snode写博'
    });
  });
};

exports.getEdit = function(req, res) {
  return dao.findOne({
    id: req.params.id
  }, function(err, blog) {
    return res.render('admin/blog-edit', {
      title: 'snode博客编辑',
      blog: blog
    });
  });
};

exports.postEdit = function(req, res) {
  var blog;
  blog = req.body.blog;
  console.log(blog);
  return dao.update(blog, function(err, results) {
    return dao.all({}, {
      only: ['id', 'title', 'del_status'],
      order: ['-id']
    }, function(err, blogs) {
      return res.render('admin/index', {
        title: 'Snode管理后台',
        blogs: blogs
      });
    });
  });
};
